[
  {
    "Id": "566492",
    "ThreadId": "246113",
    "Html": "\r\n<p><span lang=\"EN-US\" style=\"font-size:11pt\">After I saw John Papa&rsquo;s presentation Kung Fu Silverlight I made similar project. Everything works fine till I added another View and ViewModel to process another entity, declaring of EmployeeViewModel employee\r\n doesn't work (execute OnEditEmployee, correct selectedEmployee (from ListBox) pass to EditEmployeeWindow, but in the EditEmployeeWindow shows that as set in GetEmployeesCallback.\r\n</span></p>\r\n<p><span lang=\"EN-US\" style=\"font-size:11pt\">This is only then i declare <span style=\"color:red\">\r\nEmployeeViewModel employee<span style=\"color:black\"> in </span></span>ViewModelLocator (red color),\r\n<span style=\"color:fuchsia\">DepartmentViewModel department <span style=\"color:black\">\r\nworks correct.</span></span></span></p>\r\n<p><span lang=\"EN-US\" style=\"font-size:11pt; color:black\">The question is how can i declare correct EmployeeViewModel employee and others in\r\n</span><span lang=\"EN-US\" style=\"font-size:11pt\">ViewModelLocator?</span></p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> EmployeeViewModel : ViewModel\r\n    {\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> LoadDepartments()\r\n        {\r\n            Departments.Clear();\r\n            DepartmentDataService.GetEmployees(GetEmployeesCallback);\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> GetEmployeesCallback(IEnumerable&lt;department&gt; departments)\r\n        {\r\n            <span style=\"color:blue\">if</span> (departments != <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> department <span style=\"color:blue\">in</span> departments)\r\n                {\r\n                    Employees.Add(department);\r\n                }\r\n                <span style=\"color:blue\">if</span> (Employees.Count &gt; 0)\r\n                {\r\n                    <span style=\"color:#800000\"><em>SelectedEmployee = Employees[0];\r\n</em></span>                }\r\n              }\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> OnEditEmployee()\r\n        {\r\n            Messenger.Default.Send(<span style=\"color:blue\">new</span> LaunchEditEmployeeMessage() { employee = SelectedEmployee });\r\n        }\r\n\r\n}\r\n<br></pre>\r\n</div>\r\n<p></p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> employeeView : Page\r\n    {\r\n        <span style=\"color:blue\">public</span> employeeView()\r\n        {\r\n            InitializeComponent();\r\n            RegisterMessages();\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> RegisterMessages()\r\n        {\r\n            Messenger.Default.Register&lt;LaunchEditEmployeeMessage&gt;(<span style=\"color:blue\">this</span>, OnLaunchEditEmployee);\r\n            Messenger.Default.Register&lt;SaveEmployeeDialogMessage&gt;(<span style=\"color:blue\">this</span>, OnEditEmployeeDialogMessageReceived);\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> OnLaunchEditEmployee(LaunchEditEmployeeMessage msg)\r\n        {\r\n            <span style=\"color:blue\">var</span> editEmployee = <span style=\"color:blue\">new</span> EditEmployeeWindow();\r\n            editEmployee.Show();\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> OnEditEmployeeDialogMessageReceived(SaveEmployeeDialogMessage msg)\r\n        {\r\n            MessageBox.Show(msg.Content, msg.Caption, msg.Button);\r\n        }\r\n\r\n}\r\n<br></pre>\r\n</div>\r\n<p></p>\r\n<p>&lt;navigation:Page&nbsp;&nbsp;&nbsp; xmlns:local=&quot;clr-namespace:departmentTechManager&quot;<br>\r\n&nbsp;&nbsp;&nbsp; x:Class=&quot;departmentTechManager.Views.employeeView&quot; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br>\r\n&nbsp;&nbsp;&nbsp; xmlns:mvvmlightcmd=&quot;clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.SL4&quot;<br>\r\n&nbsp;&nbsp;&nbsp; <span style=\"color:#ff00ff\">DataContext=&quot;{Binding employee, Source={StaticResource Locator}}</span>&quot;&gt;&nbsp;&nbsp;&nbsp;</p>\r\n<p>&lt;grid&gt;&lt;sdk:Page.Resources&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DataTemplate x:Key=&quot;employeeItemTemplate&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel Orientation=&quot;Horizontal&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Text=&quot;{Binding name}&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DataTemplate&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/sdk:Page.Resources&gt;</p>\r\n<p>...</p>\r\n<p>&lt;ListBox ItemsSource=&quot;{Binding Employees}&quot;&nbsp;&nbsp; x:Name=&quot;employeeListBox&quot;&nbsp; ItemTemplate=&quot;{StaticResource employeeItemTemplate}&quot;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; SelectedItem=&quot;{Binding SelectedEmployee, Mode=TwoWay}&quot;&nbsp; /&gt;&lt;grid/&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>public class ViewModelLocator<br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly ServiceProviderBase _sp;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ViewModelLocator()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _sp = ServiceProviderBase.Instance;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 1 VM for all places that use it. Just an option<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:#ff00ff\">\r\ndepartment = new DepartmentViewModel(_sp.PageConductor, _sp.DepartmentDataService);\r\n</span>//this works<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:#ff00ff\">public DepartmentViewModel department { get; set; }\r\n</span>//this works<br>\r\n<br>\r\n</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //this doesn't work<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:#ff0000\">public EmployeeViewModel employee</span><br>\r\n<span style=\"color:#ff0000\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br>\r\n<span style=\"color:#ff0000\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return new EmployeeViewModel(_sp.PageConductor, _sp.EmployeeDataService); }</span><br>\r\n<span style=\"color:#ff0000\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; }</p>\r\n",
    "PostedDate": "2011-02-15T07:11:18.32-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "566502",
    "ThreadId": "246113",
    "Html": "<p>one more thing, there is Assets\\ObjectResourceDictionary.xaml</p>\r\n<p>&lt;ResourceDictionary<br />&nbsp;&nbsp;&nbsp; xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" <br />&nbsp;&nbsp;&nbsp; xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"<br />&nbsp;&nbsp;&nbsp; xmlns:local1=\"clr-namespace:departmentTechManager.ViewModels\" <br />&nbsp;&nbsp;&nbsp; xmlns:local=\"clr-namespace:departmentTechManager\" <br />&nbsp;&nbsp;&nbsp; xmlns:Common=\"clr-namespace:departmentTechManager.Papa.Common\" &gt;<br />&nbsp;&nbsp;&nbsp; &lt;Common:BoolToVisibilityConverter x:Key=\"BoolToVisibilityConverter\"/&gt;<br />&nbsp;&nbsp;&nbsp; &lt;<span style=\"color: #ff0000;\">local:ViewModelLocator x:Key=\"Locator\" </span>/&gt;<br />&lt;/ResourceDictionary&gt;</p>",
    "PostedDate": "2011-02-15T07:25:26.897-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "567161",
    "ThreadId": "246113",
    "Html": "<p><span style=\"font-size: 10pt;\" lang=\"EN-US\">Sorry, the question was almost stupid. I&rsquo;ve solved the problem, just read properly MVVM light toolkit manual, although I&rsquo;ve had to remove readonly property from ServiceProviderBase and use Quick Replace instead of MvvmLight.Snippets (use VS2010 Express).</span></p>\r\n<p><span style=\"font-size: 10pt;\" lang=\"EN-US\">here is the code:<br /></span></p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">public</span> <span style=\"color: blue;\">class</span> ViewModelLocator\r\n\r\n    {\r\n\r\n        <span style=\"color: blue;\">private</span> <span style=\"color: blue;\">static</span>  ServiceProviderBase _sp;<span style=\"color: green;\">//readonly</span>\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Cleans up all the resources.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">static</span> <span style=\"color: blue;\">void</span> Cleanup()\r\n\r\n        {\r\n\r\n            Cleardepartment();\r\n\r\n            Clearemployee();\r\n\r\n        }\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Initializes a new instance of the ViewModelLocator class.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        <span style=\"color: blue;\">public</span> ViewModelLocator()\r\n\r\n        {\r\n\r\n \r\n\r\n            _sp = ServiceProviderBase.Instance;\r\n\r\n \r\n\r\n            <span style=\"color: green;\">//CreateMain();</span>\r\n\r\n \r\n\r\n            Createdepartment();\r\n\r\n            Createemployee();\r\n\r\n \r\n\r\n        }\r\n\r\n \r\n\r\n \r\n\r\n<span style=\"color: blue;\">#region</span> DepartmentViewModel\r\n\r\n        <span style=\"color: blue;\">private</span> <span style=\"color: blue;\">static</span> DepartmentViewModel _department;\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Gets the department property.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">static</span> DepartmentViewModel departmentStatic\r\n\r\n        {\r\n\r\n            <span style=\"color: blue;\">get</span>\r\n\r\n            {\r\n\r\n                <span style=\"color: blue;\">if</span> (_department == <span style=\"color: blue;\">null</span>)\r\n\r\n                {\r\n\r\n                    Createdepartment();\r\n\r\n                }\r\n\r\n \r\n\r\n                <span style=\"color: blue;\">return</span> _department;\r\n\r\n            }\r\n\r\n        }\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Gets the department property.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        [System.Diagnostics.CodeAnalysis.SuppressMessage(<span style=\"color: #a31515;\">\"Microsoft.Performance\"</span>,\r\n\r\n            <span style=\"color: #a31515;\">\"CA1822:MarkMembersAsStatic\"</span>,\r\n\r\n            Justification = <span style=\"color: #a31515;\">\"This non-static member is needed for data binding purposes.\"</span>)]\r\n\r\n        <span style=\"color: blue;\">public</span> DepartmentViewModel department\r\n\r\n        {\r\n\r\n            <span style=\"color: blue;\">get</span>\r\n\r\n            {\r\n\r\n                <span style=\"color: blue;\">return</span> departmentStatic;\r\n\r\n            }\r\n\r\n        }\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Provides a deterministic way to delete the department property.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">static</span> <span style=\"color: blue;\">void</span> Cleardepartment()\r\n\r\n        {\r\n\r\n            <span style=\"color: green;\">//do it later</span>\r\n\r\n            <span style=\"color: green;\">//_department.Cleanup();</span>\r\n\r\n            _department = <span style=\"color: blue;\">null</span>;\r\n\r\n        }\r\n\r\n \r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n\r\n        <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Provides a deterministic way to create the department property.</span>\r\n\r\n        <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n\r\n        <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">static</span> <span style=\"color: blue;\">void</span> Createdepartment()\r\n\r\n        {\r\n\r\n            <span style=\"color: blue;\">if</span> (_department == <span style=\"color: blue;\">null</span>)\r\n\r\n            {\r\n\r\n                _department = <span style=\"color: blue;\">new</span> DepartmentViewModel(_sp.PageConductor, _sp.DepartmentDataService);\r\n\r\n            }\r\n\r\n        }\r\n\r\n        <span style=\"color: blue;\">#endregion</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-02-16T07:08:27.98-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]